serviceMetaInfo:
  host: http://account-service
  port: 6000
  serviceAppName: account-service # spring.application.name
  contextPath: /accounts

springConfig:
  security:
    oauth2:
      resource:
        user-info-uri: http://auth-service:5000/uaa/users/current

restapis:
  '/': 
    POST:
      method: '<com.piggymetrics.account.controller.AccountController: com.piggymetrics.account.domain.Account createNewAccount(com.piggymetrics.account.domain.User)>'
      # security:
      parameters:
        user:
          in: body
          type: com.piggymetrics.account.domain.User
      response:
        '200':
          description: 'OK'
          data:
            object: 'com.piggymetrics.account.domain.Account'
        '401':
          description: 'Unauthorized'
        '403':
          description: 'Forbidden'
        '404':
          description: 'Not Found'

  '/{name}':
    GET: 
      method: '<com.piggymetrics.account.controller.AccountController: com.piggymetrics.account.domain.Account getAccountByName(java.lang.String)>'
      security: 
        - oauth2.hasScope('server')
        - name.equals('demo')
      parameters:
        name:
          in: path # or query, cookie, ...
          type: java.lang.String
      response:
        '200': 
          description: 'OK'
          data: 
            object: 'com.piggymetrics.account.domain.Account'
        '401':
          description: 'Unauthorized'
        '403':
          description: 'Forbidden'
        '404':
          description: 'Not Found' 
          
  '/current':
    GET: 
      method: '<com.piggymetrics.account.controller.AccountController: com.piggymetrics.account.domain.Account getCurrentAccount(java.security.Principal)>'
      # security: 
      parameters:
        principal:
          in: body
          type: java.security.Principal
      response:
        '200':
          description: 'OK'
          data: 
            object: 'com.piggymetrics.account.domain.Account'
        '401':
          description: 'Unauthorized'
        '403':
          description: 'Forbidden'
        '404':
          description: 'Not Found' 

    PUT: 
      method: '<com.piggymetrics.account.controller.AccountController: void saveCurrentAccount(java.security.Principal,com.piggymetrics.account.domain.Account)>'
      # security: 
      parameters:
        principal:
          in: body
          type: java.security.Principal
        account:
          in: body
          type: com.piggymetrics.statistics.domain.Account
      requestBody: 
        data:
          object: 'com.piggymetrics.account.domain.User'
      response:
        '200':  # since the method is void, the response should be empty?
          description: 'OK'
        '401':
          description: 'Unauthorized'
        '403':
          description: 'Forbidden'
        '404':
          description: 'Not Found' 


calls:
  '<com.piggymetrics.account.client.StatisticsServiceClient: java.util.List getStatisticsByAccountName(java.lang.String)>':
    serviceName: 'statistics-service'
    endpoint: '/statistics/{accountName}'
    httpMethod: GET
    parameters: 
      accountName: 
        in: path
        type: java.lang.String
    security:
      - oauth2.hasScope('server')
      - name.equals('demo')

  '<com.piggymetrics.account.client.AuthServiceClient: void createUser(com.piggymetrics.account.domain.User)>':
    serviceName: 'auth-service'
    endpoint: '/uaa/users'
    httpMethod: POST
    parameters:
      user:
        in: body
        type: com.piggymetrics.account.domain.User
    security:
      - oauth2.hasScope('server')